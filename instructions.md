# dynamicEndocastByBone -- Details and Instructions
_Note: This document is in the process of being updated, stay tuned for additional detail/tutorials_

## Before running the script
You need:   
* The scripts from this package copied into your MATLAB path.
* 3D points defining the endocast (from Autodesk Maya)
* RBT of the reference bone (from XMALab)
### Determine optimal freeze increment
Freeze increments should be selected based upon frequency of behavior (we recommend roughly 10% of behavior duration). Researchers should additionally examine the "delta volume" curves at various freeze increments to check for oversmoothing.
## Inputs and call syntax

`dynamicEndocastByBone` supports both GUI and command line initialization. For GUI-based interaction, simply run this in the MATLAB console:
```matlab
dynamicEndocastByBone
```
If you wish to explicitly declare the function inputs (useful for automation), you can run this:
```matlab
dynamicEndocastByBone(datapath,XYZfile,RBTfile,refbone,freezeIncrement,savepath,savefile,objFolder)
```

In either case, the function requires the following inputs: 
1. `datapath` - *string* - full path of your data files
2. `XYZfile` - *string* - full path of the CSV file containing XYZ locator positions through time (generated by Maya function)
3. `RBTfile` - *string* - full path of the CSV file containing the rigid body transformation of the reference bone (**typically the neurocranium**)
4. `refbone` - *string* - **exact** name of reference bone as used in column headers in XYZFile (e.g. ...)
5. `freezeIncrement` - *double* - duration of rolling freeze, typically ~5-20
6. `filter` - *boolean* - toggle for a 3-frame moving average filter
7. `savepath` - *string* - where to save the data
8. `savefile` - *string* - filename data
9. `objFolder` - *string* - where to save the endocast OBJs, if save is desired

## Calculate RCVC
The instantaneous relative contribution to volume change (RCVC) of the _i_ th bone can be calculated using the following equation:
![RCVC equation](https://user-images.githubusercontent.com/69591714/149567304-6a9bf924-9ff1-4e39-8408-d8fced3c168c.PNG)

where: 
&Delta;_VFull_ is the change in endocast volume without any bones frozen,
&Delta;_VFrozenBone i/j_ is the change in endocast volume with the _i_ th or _j_ th bone frozen,
and _n_ is the number of bones frozen (i.e., does not include the reference bone).


## Visual checks in Maya
Use 'exportAlphaShapeAsOBJ.m' and 'impHullsNew.mel' to verify that the alpha hulls for each frozen bone are behaving as anticipated.
